<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">

<head>
    <meta charset="UTF-8">
    <title>Banking</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
        integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
    <link rel="stylesheet" href="./assets/css/index.css">
    <link rel="stylesheet" href="./assets/css/style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>

</head>

<body>
    <div class="container">
        <div class="table-title">
            <div class="row">
                <div class="col-sm-5">
                    <h1>Create customers</h1>
                </div>
            </div>
        </div>
        <div>
            <div>
                <!-- Form edit -->
                <div class="model-container">
                    <div class="model">
                        <div class="modelheader">
                            <div class="modeltitle"> Customer information!</div>
                            <div class="closemodel" onclick="closeEdit()">&times;</div>
                        </div>
                        <hr>
                        <div class="modelbody">
                            <div class="modelfirst">
                                <div class="descript">
                                    <form>
                                        <div class="row mt-3">
                                            <div class="col-sm-6">
                                                <label for="fullName" class="form-label"><strong>Full
                                                        Name</strong></label>
                                                <input type="text" id="fullName" class="form-control">
                                            </div>
                                            <div class="col-sm-6">
                                                <label for="email" class="form-label"><strong>Email</strong></label>
                                                <input type="text" id="email" class="form-control">
                                            </div>
                                        </div>
                                        <div class="row mt-3">
                                            <div class="col-sm-6">
                                                <label for="phone" class="form-label"><strong>Phone</strong></label>
                                                <input type="text" id="phone" class="form-control">
                                            </div>
                                            <div class="col-sm-6">
                                                <label for="address" class="form-label"><strong>Address</strong></label>
                                                <input type="text" id="address" class="form-control">
                                            </div>
                                        </div>
                                        <div class="row justify-content-end mt-3">
                                            <div class="col-sm-2" style="padding: 0px !important;">
                                                <button class="btn-3btn btn-danger" onclick="closeEdit()"
                                                    style="float: right;">Cancel</button>
                                            </div>
                                            <div class="col-sm-3">
                                                <button class="btn-3btn btn-primary ">Save Changes</button>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- form delete -->
                <div class="model-delete">
                    <div class="model" style="width: 450px; height: 300px; margin-left: 530px;">
                        <div class="modelheader delete-header" onclick="closeDelete()">
                            <div class="modeltitle">
                                <i class="fa fa-circle-exclamation" style="font-size: 70px;"></i>
                            </div>
                        </div>
                        <div class="modelbody mt-4">
                            <div class="modelfirst">
                                <div class="descript" style="margin-top: 40px;">
                                    <form>
                                        <p style="padding: 15px;">Are you sure you want to delete the selected data?</p>
                                        <div style="display: flex; justify-content: center;">
                                            <div style="padding: 5px;">
                                                <button class="btn-3btn btn-primary">Yes,delete it!</button>
                                            </div>
                                            <div style="padding: 5px;">
                                                <button class="btn-3btn btn-danger"
                                                    onclick="closeDelete()">Cancel</button>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div>
                    <form>
                        <div class="row mt-3">
                            <div class="col-sm-6">
                                <label for="fullName" class="form-label"><strong>Full name</strong></label>
                                <input type="text" id="fullName" class="form-control">
                            </div>
                            <div class="col-sm-6">
                                <label for="email" class="form-label"><strong>Email</strong></label>
                                <input type="text" id="email" class="form-control">
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-sm-6">
                                <label for="phone" class="form-label"><strong>Phone</strong></label>
                                <input type="text" id="phone" class="form-control">
                            </div>
                            <div class="col-sm-6">
                                <label for="address" class="form-label"><strong>Address</strong></label>
                                <input type="text" id="address" class="form-control">
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-lg-3">
                                <button type="button" class="btn btn-outline-primary" onclick="addCustomer()">
                                    <i class="fas fa-plus"></i>
                                    Create customer
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="table-list" style="margin-top: 20px;">
                    <table class="table table-borderless table-hover" border="1" id="tbCustomer">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>FullName</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Address</th>
                                <th colspan="5" style="text-align:center;">Action</th>
                            </tr>
                        </thead>
                        <tbody>

                        </tbody>
                    </table>
                </div>
            </div>

            <script src="./assets/js/banking.js"></script>
            <script src="./assets/js/index.js"></script>

            <script>
                var customers = [];

                var key = "data"

                function init() {

                    customers = [
                        new Customer(1, "NVA", "nva@co.cc", "12345", "28NTP"),
                        new Customer(2, "NVB", "nvb@co.cc", "54321", "28NTP"),
                        new Customer(3, "NVC", "nvc@co.cc", "55555", "28NTP")
                    ]

                }

                function renderCustomer() {
                    let html = customers.map(function (customer, index) {
                        return `<tr>
                                <td class = "text-center">${customer.id}</td>
                                <td>${customer.fullName}</td>
                                <td class = "text-center">${customer.email}</td>
                                <td class = "text-center">${customer.phone}</td>
                                <td class = "text-center">${customer.address}</td>
                                <td class="text-center">
                                    <a class="btn btn-outline-secondary" title="Edit" data-toggle="tooltip" onclick="makeEdit(${customer.id})" style="border: none;" data-id = "${index}">
                                        <i class="fas fa-pen-square" aria-hidden="true"></i>Edit
                                    </a>
                                </td>
                                <td class="text-center">
                                    <a class="btn btn-outline-danger" title="Delete" onclick="makeDelete()" data-toggle="tooltip" data-id = "${index}">Delete
                                    </a>
                                </td>
                            </tr>
                        `;
                    })
                    document.querySelector(`tbody`).innerHTML = html.join("");

                }

                function addCustomer() {
                    let id = findMaxId() + 1;
                    let fullName = document.querySelector("#fullName").value;
                    let email = document.querySelector("#email").value;
                    let phone = document.querySelector("#phone").value;
                    let address = document.querySelector("#address").value;
                    if (fullName.trim() == "" || fullName == null) {
                        alert('input new fullName!')
                        return;
                    }
                    let customer = new Customer(id, fullName, email, phone, address);
                    customers.push(customer);
                    renderCustomer();
                }


                function findMaxId() {
                    let max = 0;
                    for (let customer of customers) {
                        if (customer.id > max) {
                            max = customer.id;
                        }
                    }
                    return max;
                }

                function getCustomer(customerId) {
                    let customer = customers.find(function (customer) {
                        return customer.id === gearId;
                    })

                    document.querySelector('#fullName').value = gear.fullName;
                    document.querySelector('#email').value = gear.email;
                    document.querySelector('#phone').value = gear.phone;
                    document.querySelector('#address').value = gear.address;
                    
                }

                function makeEdit() {
                    document.querySelector(".model-container").classList.add('show');
                    getCustomer();
                    if (fullName.trim() == "" || fullName == null) {
                        alert('input new title!')
                        return;
                    }
                    let id = document.querySelector(`#customerID`).value;
                    let customer = customer.find(function (gr) {
                        return gr.id == id;
                    })
                    customer.fullName = document.querySelector("#fullName").value;
                    customer.email = document.querySelector("#email").value;
                    customer.phone = document.querySelector("#phone").value;
                    customer.address = document.querySelector("#address").value;
                    closeEdit();
                    renderGear();
                }

                function main() {
                    init();
                    renderCustomer();
                }

                main();
            </script>

</body>

</html>